CREATE TABLE `compras` ( `id` bigint(20) NOT NULL auto_increment, `id_proveedor` bigint(20) NOT NULL, `fecha` date NOT NULL, `total` decimal(20,3) NOT NULL, `id_caja` bigint(20) NULL REFERENCES `movimiento_caja`(`id_op_caja`), `contado` boolean NOT NULL DEFAULT 1, PRIMARY KEY  (`id`) ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci;
CREATE TABLE `compras_productos` ( `id` bigint(20) NOT NULL auto_increment, `id_compra` bigint(20) NOT NULL, `id_producto` bigint(20) NOT NULL, `precio_compra` decimal(20,3) NOT NULL, `cantidad` decimal(20,3) NOT NULL, PRIMARY KEY  (`id`) ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci;
CREATE VIEW IF NOT EXISTS resumen_compra AS SELECT COUNT( id ) as cantidad, fecha, MONTH( fecha ) as mes, YEAR( fecha ) as ano, SUM( total ) total, id_proveedor, contado FROM compras;